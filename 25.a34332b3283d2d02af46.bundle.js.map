{"version":3,"file":"25.a34332b3283d2d02af46.bundle.js","sources":["webpack:///../superset-ui-legacy-plugin-chart-horizon/esm/HorizonRow.js"],"sourcesContent":["function _extends(){return _extends=Object.assign||function(a){for(var b,c=1;c<arguments.length;c++)for(var d in b=arguments[c],b)Object.prototype.hasOwnProperty.call(b,d)&&(a[d]=b[d]);return a},_extends.apply(this,arguments)}function _inheritsLoose(a,b){a.prototype=Object.create(b.prototype),a.prototype.constructor=a,a.__proto__=b}/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */ /* eslint-disable sort-keys, complexity, no-magic-numbers, no-continue, no-plusplus, no-bitwise */import React from\"react\";import PropTypes from\"prop-types\";import{extent as d3Extent}from\"d3-array\";import{scaleLinear}from\"d3-scale\";export var DEFAULT_COLORS=[\"#313695\",\"#4575b4\",\"#74add1\",\"#abd9e9\",\"#fee090\",\"#fdae61\",\"#f46d43\",\"#d73027\"];var propTypes={className:PropTypes.string,width:PropTypes.number,height:PropTypes.number,data:PropTypes.arrayOf(PropTypes.shape({y:PropTypes.number})).isRequired,bands:PropTypes.number,colors:PropTypes.arrayOf(PropTypes.string),colorScale:PropTypes.string,mode:PropTypes.string,offsetX:PropTypes.number,title:PropTypes.string,yDomain:PropTypes.arrayOf(PropTypes.number)},defaultProps={className:\"\",width:800,height:20,bands:DEFAULT_COLORS.length>>1,colors:DEFAULT_COLORS,colorScale:\"series\",mode:\"offset\",offsetX:0,title:\"\",yDomain:void 0},HorizonRow=/*#__PURE__*/function(a){function b(){return a.apply(this,arguments)||this}_inheritsLoose(b,a);var c=b.prototype;return c.componentDidMount=function componentDidMount(){this.drawChart()},c.componentDidUpdate=function componentDidUpdate(){this.drawChart()},c.componentWillUnmount=function componentWillUnmount(){this.canvas=null},c.drawChart=function drawChart(){if(this.canvas){var a=this.props,c=a.data,d=a.yDomain,e=a.width,f=a.height,g=a.bands,h=a.colors,j=a.colorScale,k=a.offsetX,l=a.mode,m=\"change\"===j?c.map(function(a){return _extends({},a,{y:a.y-c[0].y})}):c,n=this.canvas.getContext(\"2d\");n.imageSmoothingEnabled=!1,n.clearRect(0,0,e,f),n.setTransform(1,0,0,1,0,0),n.translate(.5,.5);var o=e/m.length,p=Math.floor(Math.max(0,-(k/o))),q=Math.floor(Math.min(m.length,p+e/o));// the data frame currently being shown:\n// skip drawing if there's no data to be drawn\nif(p>m.length)return;// Create y-scale\nfor(var r,s,t=d||d3Extent(m,function(a){return a.y}),u=t[0],v=t[1],w=scaleLinear().domain([0,Math.max(-u,v)]).range([0,f]),x=!1,y=0;y<g;y+=1){n.fillStyle=h[g+y],s=(y+1-g)*f,w.range([g*f+s,s]);// only the current data frame is being drawn i.e. what's visible:\nfor(var z=p;z<q;z++){if(r=m[z].y,0>=r){x=!0;continue}void 0!==r&&n.fillRect(k+z*o,w(r),o+1,w(0)-w(r))}}// draw negative bands\nif(x){\"offset\"===l&&(n.translate(0,f),n.scale(1,-1));for(var i=0;i<g;i++){n.fillStyle=h[g-i-1],s=(i+1-g)*f,w.range([g*f+s,s]);// only the current data frame is being drawn i.e. what's visible:\nfor(var A=p;A<q;A++)(r=m[A].y,!(0<=r))&&n.fillRect(k+A*o,w(-r),o+1,w(0)-w(-r))}}}},c.render=function render(){var a=this,b=this.props,c=b.className,d=b.title,e=b.width,f=b.height;return React.createElement(\"div\",{className:\"horizon-row \"+c},React.createElement(\"span\",{className:\"title\"},d),React.createElement(\"canvas\",{width:e,height:f,ref:function ref(b){a.canvas=b}}))},b}(React.PureComponent);HorizonRow.propTypes=propTypes,HorizonRow.defaultProps=defaultProps;export default HorizonRow;"],"mappings":"AAAA","sourceRoot":""}